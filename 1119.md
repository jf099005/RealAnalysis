
# Differentiation of Monotone functions
$f(x_0)$ is finite
- $D_1 f(x_0) = \limsup_{h\to 0^+} \frac{f(x_0+h)-f(x_0)}{h}$
- $D_2 f(x_0) = \liminf_{h\to 0^+} \frac{f(x_0+h)-f(x_0)}{h}$
- $D_3 f(x_0) = \limsup_{h\to 0^-} \frac{f(x_0+h)-f(x_0)}{h}$
- $D_4 f(x_0) = \liminf_{h\to 0^-} \frac{f(x_0+h)-f(x_0)}{h}$

$f$ differentiable at $x_0$ $\iff$ $D_1 f(x_0)=D_2 f(x_0)=D_3 f(x_0)=D_4 f(x_0)$



Let $r>s>0$ and $A=A_{r,s}=\{x\in E:D_1 f(x) > r > s > D_4f(x)\}$
then $|A|_e=0$

Claim: $|A|_e=0$
if $x\in A$ then from $D_4 f(x)<s$, we have $\frac{f(x-h)-f(x)}{-h} < s\forall$ sufficiently small $h>0$

That is, $A$ can be coverd by interval $[x-h,x]$ with small $h>0$ (in the Vitali sense)

By the Vitali Lemma, given $\epsilon>0$, $\exists$ disjoint intervals $[x_j-h_j, x_j],j=1,2,...,N$ s.t.
- 1. $f(x_j)-f(x_j-h_j) < s h_j \forall j$
- 2. $|A\cap \cup_{j=1}^N [x_j-h_j, x_j] | > |A|_e-\epsilon$
- 3. $\sum_{j=1}^N h_j < (1+\epsilon)|A|_e$

(i) \& (iii) $\implies \sum_{j=1}^N [f(x_j)-f(x_j-h_j)] \le s(1+\epsilon)|A|_e$


Let $B=A\cap \cup_{j=1}^N [x_j-h_j, x_j]$. for any $y\in B$, but not on endpoint of interval $[x_j-h_j, x_j]$, by $D_1 f(y) > r$, we have

$\frac{f(y+k)-f(y)}{k} > r \forall k$ small and $[y,y+k]$ lie in some $[x_j-h, x_j]$

By Vitali covering lemma again, there exist disjoint intervals $[y_i,y_i+k_i],j=1,2,...,M$ s.t.
- a. $[y_i, y_i+k_i] \subseteq [x_j-h_j, x_j]$ for some $j$
- b. $f(y_i+k_i) - f(y_i) > rk_i\forall i$
- c. $\sum_{i=1}^M k_i > |B|_e - \epsilon\underbrace{> |A|_e -2\epsilon}_{\rm from (ii)}$ 

by (b.), we obtain
$\sum_{i=1}^M [f(y_i+k_i) - f(y_i)] \ge r (|A|_e -2\epsilon)$

since $f$ is monotone increasing, 
$\sum_{i=1}^M [f(y_i+k_i) - f(y_i)] \le \sum_{j=1}^N[f(x_j - h_j) - f(x_j)]$

$\implies r (|A|_\epsilon - 2\epsilon) \le s(1+\epsilon) |A|_e \forall \epsilon>0$

$\implies r\le s$, which is a contradiction

$\implies |A|_e$ need to be $0$, 

with the same argument, we can prove $|A|_e=0$ for any pair of $D_i f(x)$, therefore $f$ is differentiable a.e.

Also, $f'\ge 0$ whenever $f'$ exists

Next, we want to show that
$\int_a^b f' \le f(b^-)-f(a^+)$

Extend the definitoin of $f$ by setting $f(x)=f(b^-)$ if $x>b$

Let $f_k(x)=\frac{f(x+h) - f(x)}{h},h=\frac 1k$

So, $\{f_k\}$ are nonnegative, measurable, and $f_k\to f'$ a.e. in $(a,b)$

By Fatou's Lemma, $\int_a^b f' \le \liminf_{k\to\infty} \int_a^b f_k$

We may assume that $f(b^-)<\infty$, otherwise the inequality is trivial

So, $\int_a^b f_k = \int_a^b \frac{f(x+h)- f(x)}{h}h = \frac 1h \int_{a+h}^{b+h} f - \frac 1h \int_a^b f$
$=\frac 1h \int_b^{b+h} f - \frac 1h \int_a^{a+h} f$

$f$ increasing $\implies f(a^+) \le \int\frac 1h \int_a^{a+h} f \le f(a+h) = f(a+\frac 1k)\to f(a^+)$

hence, $\int_a^b f' \le f(b^-)-f(a^+)$

#### remark
there exists and example s.t. the strict inequality holds, e.g. the Cantor-Lebesgue function:
- $f$ is monotone increasing, $f'=0$ a.e. in $[0,1]$
- $f(0)=0,f(1)=1$

$\implies \int_0^1 f' = 0 < f(1)-f(0)=1$

## Corollary
if $f$ is of bounded variation on $[a,b]$, then $f'$ exists a.e. in $[a,b]$, and $f' \in L(a,b)$

# Absolute continuous function

## Theorem
If $f$ is of bounded variation on $[a,b]$, and $V(x)$ is the total variatoin of $f$ on $[a,x]$

note that $V$ is monotone increasing, so $V'(x)$ exists a.e. in $[a,b]$
Also, $V'(x)=|f'(x)| \forall x$ a.e.

## Def.
Let $f$ be defined on $[a,b]$ ( finite), then $f$ is said to be **absolutely continuous** on $[a,b]$ if $\forall \epsilon>0,\exists \delta>0$ s.t.

for any collection of non-overlapping intervals $\{[a_j, b_j]\}$ (finite or infinite) satisfying $\sum_{j} b_j-a_j < \delta$, we have $\sum_{j} |f(b_j)-f(a_j)| < \epsilon$

it can implies $f$ is unif. continuous

### Example 1
if $f$ is Lipchitz, then $f$ is abs.

### Example 2
Let $g\in L[a,b]$, define the indefinite integral $G(x)=\int_a^x g$, then $G$ is abs:

$\sum_i |G(b_i)-G(a_i)|=\sum_i |\int_{a_i}^{b_i} g| = \int_{\cup_i [a_i, b_i]} |g|$

So we need to show that if $g\in L[a,b]$ and $A\subseteq [a,b]$ with $|A|<\delta$, then $\int_A g < \delta$

#### Lemma.
Assume $f\ge 0$ and $f\in L(E)$ with a measurable set $E$, then $\forall \epsilon>0,\exists \delta>0$ s.t.
- if $A\subseteq E$, $|A|<\delta$, then $\int_A f < \epsilon$

proof:
since $f\in L(E)$, $\int_{\{f\ge k\}} f\to 0$ as $k\to\infty$
so, $\forall \epsilon>0,\exists k_0 >> 1$ s.t. $\int\{f\ge k_0\} f < \epsilon/2$, write $k_0= k(\epsilon_0)$

Now for such $k_0$, we have
$\int_{A} f \le \int_{A\cap \{f < k_0\}} f + \epsilon/2 \le k_0|A| + \epsilon/2$

hence, if we choose $\delta$ s.t. $k_0\delta < \epsilon/2$, then $\int_A f < \epsilon$

#### remark
The Cantor-Lebesgue function $f$ is cont. but not a.c.

why? $C_k=\{a_i^k,b_i^k\}$ be the remaining interval in the constrction of the 1/3 Cantor set at $k-th$ step

then $|C_k|\to 0$ as $k\to\infty$
but, $\sum_i |f(b_i^k)-f(a_i^k)|=1$

## Theorem
if $f$ is a.c. in $[a,b]$, then $f$ is of bounded variation on $[a,b]$ and $f'$ exists a.e. in $[a,b]$

proof.
since $f$ is a.c., if $\epsilon=1,\exists \delta>0$ s.t. if $\sum b_i-a_i < \delta$ then $\sum_i |f(b_i)-f(a_i)| \le 1$

Now, we partition $[a.b]$ into $N$ subintervals s.t. each subinterval has length less than $\delta$
then the total variation of $f$ on $[a,b] \le N$

## Def.
A function $f$ is said to be **singular** on $[a,b]$ if $f'=0$ a.e. on $[a,b]$

The Cantor-Lebesgue function on $[0,1]$ is a non-contant singular function

## Theorem
If $f$ is both a.c. and singular on $[a,b]$, then $f$ must be a constant function.

proof:
it suffice to show that $f(c)=f(d)$ for any $[c,d]\subseteq [a,b]$, and consider $[c,d]=[a,b]$ is sufficient

Let $E$ be a measaurable subset in $(a,b)$ with $f'=0$ on $E$ and $|E|=b-a$
For $x\in E,$ given $\epsilon>0, \exists [x,x+h]\subset (a,b)$ if $h<<1$, and $|f(x+h)-f(x)|<\epsilon h$

Let $\delta$ be the number corresponding to $\epsilon$ in the definition of a.c.

By the Vitali Covering Lemma, $\exists Q_k=[x_j, x_j+h_j],j=1,2,...,N$ disjoint s.t.
- 1. $|f(x_j+h_j)-f(x_j)|<\epsilon h_j$
- 2. $\sum_{j=1}^N |Q_j| = \sum_{j=1}^N h_j > |E|-\epsilon = (b-a)-\delta$ (using $\epsilon=\delta$ in the Vitali covering)

(i) $\implies \sum_{j=1}^N |f(x_j+h_j) - f(x_j)| < \epsilon \sum_{j=1}^N h_j < \epsilon(b-a)$

(ii) $\implies |[a,b]-\cup_j Q_j|<\delta \implies$
 the total variation of $g$ on $[a,b]-\cup_j Q_j \le \epsilon$

 Hence, $|f(b)-f(a)| < \epsilon\forall \epsilon>0\implies f(a) = f(b)$

## Theorem
if $f$ is of bounded varation on $[a,b]$, then $f$ can be written as $f=g+h$, where $g$ is a.c. and $h$ is singular.
moreover, $g$ and $h$ are unique up to a constant

## Theorem
A function $f$ is a.c. on $[a,b]$ iff $f'$ exists a.e. in $[a,b]$, $f'\in L[a,b]$ and $f(x)=f(a)+\int_a^x f'$